<link rel="import" href="../polymer/polymer.html">

<dom-module id="lq-login">
<style>
:host {
}
paper-scroll-header-panel {
    height: 100%;
}
paper-toolbar.tall .app-name {
    font-size: 40px;
    font-weight: 300;
    /* Required for main area's paper-scroll-header-panel custom condensing transformation */
    -webkit-transform-origin: left center;
    transform-origin: left center;
}

#mainToolbar {
    background-color: var(--lq-primary-0);
}
#mainToolbar .middle-container  {
    height: 100%;
    margin-left: 48px;
}

#mainToolbar:not(.tall) .middle {
    font-size: 18px;
    padding-bottom: 0;
}

/* Height of the scroll area */
.content {
    height: 900px;
}

.form {
    width: 600px;
}
.forms h4 {
    margin: 0;
    color: rgb(255, 255, 255);
    text-align: center;
    font-size: 24px;
    line-height: 100px;
}
.log-in > div {
    padding: 20px;
}
.bottom {
    margin-top: 40px;
    padding-top: 20px;
    text-align: right;
    border-top: 1px solid rgb(117, 117, 117);
}
paper-button {
    margin-bottom: 24px;
}
paper-button[raised].colorful {
    background: #4285f4;
    color: #fff;
}
.horizontal-section-container {
  @apply(--layout-horizontal);
  @apply(--layout-center-justified);
  @apply(--layout-wrap);
}

.vertical-section-container {
  @apply(--layout-vertical);
  @apply(--center-justified);
}

.horizontal-section {
  background-color: white;
  padding: 24px;
  margin-right: 24px;
  min-width: 200px;

  @apply(--shadow-elevation-2dp);
}

.vertical-section {
  background-color: white;
  padding: 24px;
  margin: 0 24px 24px 24px;

  @apply(--shadow-elevation-2dp);
}
.centered {
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
}

</style>

<template>
    <paper-scroll-header-panel main condenses keep-condensed-header on-paper-header-transform="_animateHeader">
        <paper-toolbar id="mainToolbar" class="tall">
            <!-- Application name -->
            <div class="middle middle-container center horizontal layout">
                <div class="app-name">The LanguageQUIZ</div>
            </div>
        </paper-toolbar>

        <!-- Main Content -->
        <div class="content horizontal-section-container forms">

                <div>
                    <h4>Register</h4>
                    <div class="form horizontal-section">
                        <lq-form>
                            <paper-input label="Full name*" auto-validate pattern="[a-zA-Z]*" error-message="letters only" value="{{reg.fullname}}"></paper-input>
                            <paper-input label="Email*" auto-validate type="email" error-message="enter a valid email address" value="{{reg.email}}"></paper-input>
                            <paper-input label="Re-enter email*" auto-validate type="email" error-message="enter a valid email address" value="{{reg.email_confirmation}}"></paper-input>
                            <paper-input label="Password*" auto-validate type="password" value="{{reg.password}}"></paper-input>
                            <paper-input label="Re-enter password*" auto-validate type="password" value="{{reg.password_confirmation}}"></paper-input>
                            <paper-input label="Yor nationality*" value="{{reg.nationality}}"></paper-input>
                            <div class="bottom">
                                <paper-button raised class="colorful custom" on-tap="_register"><iron-icon icon="check"></iron-icon>Register</paper-button>
                            </div>
                        </lq-form>
                    </div>
                </div>

                <div>
                    <h4>Log In</h4>
                    <div class="form horizontal-section">
                        <paper-input id="login_email" required label="E-mail" autofocus type="email" error-message="enter a valid email address" value="{{email}}"></paper-input>
                        <paper-input id="login_password" label="Password" required minlength=4 type="password" error-message="password must be 4 minimum characters" value="{{password}}"></paper-input>
                        <div class="bottom">
                            <paper-button raised class="colorful custom" on-tap="_verifyLogIn"><iron-icon icon="check"></iron-icon>ok</paper-button>
                        </div>
                    </div>
                </div>

        </div>

    </paper-scroll-header-panel>
</template>

<script>
Polymer({
    is: 'lq-login',

    properties: {
    },

    ready: function() {
    },

    attached: function() {
    },

    _animateHeader: function( e ) {
        var appName = this.querySelector('.app-name');
        var middleContainer = this.querySelector('.middle-container');
        var detail = e.detail;
        var heightDiff = detail.height - detail.condensedHeight;
        var yRatio = Math.min(1, detail.y / heightDiff);

        // appName max size when condensed. The smaller the number the smaller the condensed size.
        var maxMiddleScale = 0.50;
        var scaleMiddle = Math.max(maxMiddleScale, (heightDiff - detail.y) / (heightDiff / (1-maxMiddleScale))  + maxMiddleScale);

        // Move/translate middleContainer
        this.transform('translate3d(0,' + yRatio * 100 + '%,0)', middleContainer);

        // Scale middleContainer appName
        this.transform('scale(' + scaleMiddle + ') translateZ(0)', appName);
    },

    resetFields: function() {
        this.email = '';
        this.password = '';
    },

    _verifyLogIn: function() {
        this.$.login_email.validate();
        this.$.login_password.validate();
        if ( this.email.length > 0 && this.password.length > 0 && this.$.login_email.validate() && this.$.login_password.validate() === true ) {
            this.fire('login', {
                email    : this.email,
                password : this.password,
            });

            this.resetFields();
        }
    }

});

</script>

<dom-module>
