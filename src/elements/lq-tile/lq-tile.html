<link rel="import" href="../polymer/polymer.html">

<dom-module id="lq-tile">
<style>
:host {
	display: block;
	opacity: 0;
	margin: 12px;
	transition: all linear .4s;
}
:host([small]) iron-image {
	width: 100%;
	height: var(--lq-tile-height);
}
:host([large]) iron-image {
	width: 50%;
	height: 100%;
}
:host([loading]) {
	height: var(--lq-tile-height);

	@apply(--layout-horizontal);
	@apply(--layout-center);
	@apply(--layout-center-justified);
	@apply(--layout-flex-auto);
}
::content .description {
	height: 97px;
	overflow: hidden;
}
paper-card {
	width: 100%;
	--paper-card-header-color: var(--paper-pink-500);
}
.card-actions {
	display: flex;
}
paper-icon-button.red {
  color: var(--paper-red-500);

  --paper-icon-button-ink-color: var(--paper-red-500);
}
paper-icon-button.red:hover {
  background: var(--paper-red-50);
  border-radius: 50%;
}
iron-image {
	@apply(--layout-flex);
}
</style>

<template>
	<template is="dom-if" if="[[loading]]">
		<paper-spinner active$="{{active}}"></paper-spinner>
	</template>

	<template is="dom-if" if="[[!loading]]">
		<paper-card heading="[[title]]" class="pink"

			id="card">
			<div class="card-content">
				<iron-image id="preload3a" class="sized gray" preload placeholder="{{placeholder}}" src=[[image]]></iron-image>
				<content select=".description"></content>
			</div>
			<div class="card-actions">
				<paper-button>Nay</paper-button>
				<paper-button>Yay!</paper-button>
				<div class="flex"></div>
				<paper-icon-button icon="favorite" title="favorite" class="red"></paper-icon-button>
			</div>
		</paper-card>
	</template>
</template>

<script>
Polymer({
	is: 'lq-tile',

	properties: {
		image: {
			type: String,
			value: null,
			reflectToAttribute: true
		},

		name: {
			type: String,
			reflectToAttribute: true
		},

		loading: {
			type: Boolean,
			value: false,
			reflectToAttribute: true
		},

		placeholder: {
			type: String,
			value: appDir + "img/avatar.jpg",
		},

		small: {
			type: Boolean,
			value: false,
			reflectToAttribute: true
		},

		large: {
			type: Boolean,
			value: false,
			reflectToAttribute: true
		},

		animationConfig: {
			value: function() {
				return {
					'entry': [{
						name: 'fade-in-animation',
						timing: {
							duration: 1000,
						},
						node: this
					},
					{
						name: 'slide-down-animation',
						timing: {
							duration: 300,
						},
						node: this
					}]
				}
			}
		}
	},

	behaviors: [
		Polymer.NeonAnimationRunnerBehavior
	],
	listeners: {
		'neon-animation-finish': '_onNeonAnimationFinish'
	},

	ready: function() {
		if ( ! this.image ) {
			var path = "http://lorempixel.com/";
			path = path + this.getRandomArbitrary(345, 355) + '/' + this.getRandomArbitrary(355, 355);
			this.image = path;
		}
		this.show();
	},

	// Returns a random number between min (inclusive) and max (exclusive)
	getRandomArbitrary: function( min, max ) {
		return Math.floor(Math.random() * (max - min)) + min;
	},

	show: function() {
		this.async( function() {
			this.playAnimation('entry');
		}, 1000 );

	},
	_onNeonAnimationFinish: function() {
		this.style.opacity = 1;
	}
});
</script>
</dom-module>
