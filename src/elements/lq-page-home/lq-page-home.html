<link rel="import" href="../polymer/polymer.html">

<dom-module id="lq-page-home">
<style>
:host {
}
paper-scroll-header-panel {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: var(--paper-grey-200, #eee);

  /* background for toolbar when it is at its full size */
  --paper-scroll-header-panel-full-header: {
	background-color: var(--lq-primary-0);
  };

  /* background for toolbar when it is condensed */
  --paper-scroll-header-panel-condensed-header: {
	background-color: var(--lq-secondary-1-0);
  };
}
paper-toolbar {
  /* custom toolbar height */
  height: 200px;
  background-color: transparent;
  overflow: visible;
}
#app-title {
    font-size: 21px;
}
paper-toolbar paper-icon-button {
  margin: 0 8px;
}
.content {
	min-height: 1000px;
}
.container {
	padding: 5px;
	@apply(--layout-horizontal);
	@apply(--layout-justified);
	height: 120px;
}
.container2 {
	padding: 0 5px 5px 5px;
	@apply(--layout-horizontal);
	@apply(--layout-justified);
	height: 240px;
}
.tile {
	margin: 10px;
	text-align: center;
	@apply(--layout-flex);
	@apply(--shadow-elevation-2dp);
}
.tile_half {
	margin: 10px;
	text-align: center;
	height: 50%;
	@apply(--layout-self-end);
	@apply(--layout-flex);
	@apply(--shadow-elevation-2dp);
}
</style>

<template>
	<paper-scroll-header-panel condenses keep-condensed-header header-height="200" condensed-header-height="120">
		<paper-toolbar>
			<div id="app-title">The LanguageQUIZ</div>
			<div class="flex"></div>
			<lq-profile-logo></lq-profile-logo>

            <paper-icon-button class="bottom social" icon="assessment"></paper-icon-button>
			<div class="bottom flex"></div>
            <paper-icon-button class="bottom" icon="favorite"></paper-icon-button>
		</paper-toolbar>

		<!-- Main Content -->
		<div class="content">
			<div class="container">
				<div class="tile profile"><div class="box"><p>Profile</p></div></div>
				<div class="tile favourites"><div class="box"><p>Favourites</p></div></div>
				<div class="tile settings"><div class="box"><p>Settings</p></div></div>
				<div class="tile logout" on-tap="_logOut"><div class="box"><p>Logout</p></div></div>
			</div>
			<div class="container2">
				<div class="tile global"><div class="box"><p>Global collections</p></div></div>
				<div class="tile_half highlights"><div class="box"><p>Highlights</p></div></div>
			</div>
			<div class="container">
				<div class="tile large private"><div class="box"><p>Private Collections</p></div></div>
				<div class="tile medium scoreboard"><div class="box"><p>Scoreboard</p></div></div>
			</div>
		</div>

	</paper-scroll-header-panel>

	<iron-ajax
		id="ajax_logout"
		method="GET"
		handle-as="json"
		on-response="logOut">
	</iron-ajax>
</template>

<script>
Polymer({
	is: 'lq-page-home',

	behaviors: [
		Polymer.NeonAnimatableBehavior
	],

	properties: {
		apiDir: {
			type: String,
			reflectToAttribute: true
		},

		userProfile: {
			type: Object
		},

		animationConfig: {
			type: Object,
			value: function() {
				return {
					'entry': {
						name: 'fade-in-animation',
						node: this
					},
					'exit': {
						name: 'fade-out-animation',
						node: this
					}
				}
			}
		}

	},

	ready: function() {
		this.userProfile = {
			profilePic: "http://www.phantomshockey.com/wp-content/uploads/2014/07/profile-icon.png",
		};
	},

	attached: function() {
	},

	_animateHeader: function( e ) {
		var appName = this.querySelector('.app-name');
		var middleContainer = this.querySelector('.middle-container');
		var detail = e.detail;
		var heightDiff = detail.height - detail.condensedHeight;
		var yRatio = Math.min(1, detail.y / heightDiff);

		// appName max size when condensed. The smaller the number the smaller the condensed size.
		var maxMiddleScale = 0.50;
		var scaleMiddle = Math.max(maxMiddleScale, (heightDiff - detail.y) / (heightDiff / (1-maxMiddleScale))  + maxMiddleScale);

		// Move/translate middleContainer
		this.transform('translate3d(0,' + yRatio * 100 + '%,0)', middleContainer);

		// Scale middleContainer appName
		this.transform('scale(' + scaleMiddle + ') translateZ(0)', appName);
	},

	_logOut: function() {
		this.fire( "loading" );
		var ajax_url = this.apiDir + "api/logout";
		this.$.ajax_logout.url = ajax_url;
		this.$.ajax_logout.generateRequest();
	},

	logOut: function() {
		this.fire( "logout" );
	}

});
</script>

<dom-module>
